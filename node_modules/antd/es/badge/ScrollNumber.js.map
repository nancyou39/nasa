{"version":3,"sources":["badge/ScrollNumber.jsx"],"names":["React","omit","classNames","ConfigConsumer","getNumberArray","num","toString","split","reverse","map","i","current","Number","isNaN","renderNumberList","position","className","childrenToReturn","push","ScrollNumber","props","onAnimated","renderScrollNumber","getPrefixCls","customizePrefixCls","prefixCls","style","title","component","displayComponent","restProps","newProps","borderColor","boxShadow","cloneElement","createElement","renderNumberElement","state","animateStarted","count","_","prevState","lastCount","clearTimeout","timeout","setTimeout","setState","__","currentCount","Math","abs","currentDigit","lastDigit","getPositionByNum","removeTransition","undefined","transition","msTransform","WebkitTransform","transform","key","renderCurrentNumber","nextProps","nextState","Component","defaultProps"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport omit from 'omit.js';\nimport classNames from 'classnames';\nimport { ConfigConsumer } from '../config-provider';\nfunction getNumberArray(num) {\n    return num\n        ? num\n            .toString()\n            .split('')\n            .reverse()\n            .map(i => {\n            const current = Number(i);\n            return isNaN(current) ? i : current;\n        })\n        : [];\n}\nfunction renderNumberList(position, className) {\n    const childrenToReturn = [];\n    for (let i = 0; i < 30; i++) {\n        childrenToReturn.push(<p key={i.toString()} className={classNames(className, {\n            current: position === i,\n        })}>\n        {i % 10}\n      </p>);\n    }\n    return childrenToReturn;\n}\nclass ScrollNumber extends React.Component {\n    constructor(props) {\n        super(props);\n        this.onAnimated = () => {\n            const { onAnimated } = this.props;\n            if (onAnimated) {\n                onAnimated();\n            }\n        };\n        this.renderScrollNumber = ({ getPrefixCls }) => {\n            const { prefixCls: customizePrefixCls, className, style, title, component = 'sup', displayComponent, } = this.props;\n            // fix https://fb.me/react-unknown-prop\n            const restProps = omit(this.props, [\n                'count',\n                'onAnimated',\n                'component',\n                'prefixCls',\n                'displayComponent',\n            ]);\n            const prefixCls = getPrefixCls('scroll-number', customizePrefixCls);\n            const newProps = Object.assign(Object.assign({}, restProps), { className: classNames(prefixCls, className), title: title });\n            // allow specify the border\n            // mock border-color by box-shadow for compatible with old usage:\n            // <Badge count={4} style={{ backgroundColor: '#fff', color: '#999', borderColor: '#d9d9d9' }} />\n            if (style && style.borderColor) {\n                newProps.style = Object.assign(Object.assign({}, style), { boxShadow: `0 0 0 1px ${style.borderColor} inset` });\n            }\n            if (displayComponent) {\n                return React.cloneElement(displayComponent, {\n                    className: classNames(`${prefixCls}-custom-component`, displayComponent.props && displayComponent.props.className),\n                });\n            }\n            return React.createElement(component, newProps, this.renderNumberElement(prefixCls));\n        };\n        this.state = {\n            animateStarted: true,\n            count: props.count,\n        };\n    }\n    static getDerivedStateFromProps(nextProps, nextState) {\n        if ('count' in nextProps) {\n            if (nextState.count === nextProps.count) {\n                return null;\n            }\n            return {\n                animateStarted: true,\n            };\n        }\n        return null;\n    }\n    componentDidUpdate(_, prevState) {\n        this.lastCount = prevState.count;\n        const { animateStarted } = this.state;\n        if (animateStarted) {\n            this.clearTimeout();\n            // Let browser has time to reset the scroller before actually\n            // performing the transition.\n            this.timeout = setTimeout(() => {\n                // eslint-disable-next-line react/no-did-update-set-state\n                this.setState((__, props) => ({\n                    animateStarted: false,\n                    count: props.count,\n                }), this.onAnimated);\n            });\n        }\n    }\n    componentWillUnmount() {\n        this.clearTimeout();\n    }\n    getPositionByNum(num, i) {\n        const { count } = this.state;\n        const currentCount = Math.abs(Number(count));\n        const lastCount = Math.abs(Number(this.lastCount));\n        const currentDigit = Math.abs(getNumberArray(this.state.count)[i]);\n        const lastDigit = Math.abs(getNumberArray(this.lastCount)[i]);\n        if (this.state.animateStarted) {\n            return 10 + num;\n        }\n        // 同方向则在同一侧切换数字\n        if (currentCount > lastCount) {\n            if (currentDigit >= lastDigit) {\n                return 10 + num;\n            }\n            return 20 + num;\n        }\n        if (currentDigit <= lastDigit) {\n            return 10 + num;\n        }\n        return num;\n    }\n    renderCurrentNumber(prefixCls, num, i) {\n        if (typeof num === 'number') {\n            const position = this.getPositionByNum(num, i);\n            const removeTransition = this.state.animateStarted || getNumberArray(this.lastCount)[i] === undefined;\n            return React.createElement('span', {\n                className: `${prefixCls}-only`,\n                style: {\n                    transition: removeTransition ? 'none' : undefined,\n                    msTransform: `translateY(${-position * 100}%)`,\n                    WebkitTransform: `translateY(${-position * 100}%)`,\n                    transform: `translateY(${-position * 100}%)`,\n                },\n                key: i,\n            }, renderNumberList(position, `${prefixCls}-only-unit`));\n        }\n        return (<span key=\"symbol\" className={`${prefixCls}-symbol`}>\n        {num}\n      </span>);\n    }\n    renderNumberElement(prefixCls) {\n        const { count } = this.state;\n        if (count && Number(count) % 1 === 0) {\n            return getNumberArray(count)\n                .map((num, i) => this.renderCurrentNumber(prefixCls, num, i))\n                .reverse();\n        }\n        return count;\n    }\n    render() {\n        return <ConfigConsumer>{this.renderScrollNumber}</ConfigConsumer>;\n    }\n    clearTimeout() {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n            this.timeout = undefined;\n        }\n    }\n}\nScrollNumber.defaultProps = {\n    count: null,\n    onAnimated() { },\n};\nexport default ScrollNumber;\n"],"file":"ScrollNumber.js"}