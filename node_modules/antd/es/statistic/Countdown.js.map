{"version":3,"sources":["statistic/Countdown.jsx"],"names":["React","Statistic","formatCountdown","REFRESH_INTERVAL","getTime","value","Date","Countdown","arguments","syncTimer","props","timestamp","now","startTimer","stopTimer","countdownId","window","setInterval","forceUpdate","onFinish","clearInterval","undefined","config","format","valueRender","node","cloneElement","title","Component","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,SAASC,eAAT,QAAgC,SAAhC;AACA,IAAMC,gBAAgB,GAAG,OAAO,EAAhC;;AACA,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;AACpB,SAAO,IAAIC,IAAJ,CAASD,KAAT,EAAgBD,OAAhB,EAAP;AACH;;IACKG,S;;;AACF,uBAAc;AAAA;;AAAA;;AACV,oFAASC,SAAT;;AACA,UAAKC,SAAL,GAAiB,YAAM;AAAA,UACXJ,KADW,GACD,MAAKK,KADJ,CACXL,KADW;AAEnB,UAAMM,SAAS,GAAGP,OAAO,CAACC,KAAD,CAAzB;;AACA,UAAIM,SAAS,IAAIL,IAAI,CAACM,GAAL,EAAjB,EAA6B;AACzB,cAAKC,UAAL;AACH,OAFD,MAGK;AACD,cAAKC,SAAL;AACH;AACJ,KATD;;AAUA,UAAKD,UAAL,GAAkB,YAAM;AACpB,UAAI,MAAKE,WAAT,EACI;AACJ,YAAKA,WAAL,GAAmBC,MAAM,CAACC,WAAP,CAAmB,YAAM;AACxC,cAAKC,WAAL;AACH,OAFkB,EAEhBf,gBAFgB,CAAnB;AAGH,KAND;;AAOA,UAAKW,SAAL,GAAiB,YAAM;AAAA,wBACS,MAAKJ,KADd;AAAA,UACXS,QADW,eACXA,QADW;AAAA,UACDd,KADC,eACDA,KADC;;AAEnB,UAAI,MAAKU,WAAT,EAAsB;AAClBK,QAAAA,aAAa,CAAC,MAAKL,WAAN,CAAb;AACA,cAAKA,WAAL,GAAmBM,SAAnB;AACA,YAAMV,SAAS,GAAGP,OAAO,CAACC,KAAD,CAAzB;;AACA,YAAIc,QAAQ,IAAIR,SAAS,GAAGL,IAAI,CAACM,GAAL,EAA5B,EAAwC;AACpCO,UAAAA,QAAQ;AACX;AACJ;AACJ,KAVD;;AAWA,UAAKjB,eAAL,GAAuB,UAACG,KAAD,EAAQiB,MAAR,EAAmB;AAAA,UAC9BC,MAD8B,GACnB,MAAKb,KADc,CAC9Ba,MAD8B;AAEtC,aAAOrB,eAAe,CAACG,KAAD,EAAQ,SAAc,SAAc,EAAd,EAAkBiB,MAAlB,CAAd,EAAyC;AAAEC,QAAAA,MAAM,EAANA;AAAF,OAAzC,CAAR,CAAtB;AACH,KAHD,CA9BU,CAkCV;;;AACA,UAAKC,WAAL,GAAmB,UAACC,IAAD;AAAA,aAAUzB,KAAK,CAAC0B,YAAN,CAAmBD,IAAnB,EAAyB;AAClDE,QAAAA,KAAK,EAAEN;AAD2C,OAAzB,CAAV;AAAA,KAAnB;;AAnCU;AAsCb;;;;wCACmB;AAChB,WAAKZ,SAAL;AACH;;;yCACoB;AACjB,WAAKA,SAAL;AACH;;;2CACsB;AACnB,WAAKK,SAAL;AACH;;;6BACQ;AACL,aAAQ,oBAAC,SAAD;AAAW,QAAA,WAAW,EAAE,KAAKU;AAA7B,SAA8C,KAAKd,KAAnD;AAA0D,QAAA,SAAS,EAAE,KAAKR;AAA1E,SAAR;AACH;;;;EAnDmBF,KAAK,CAAC4B,S;;AAqD9BrB,SAAS,CAACsB,YAAV,GAAyB;AACrBN,EAAAA,MAAM,EAAE;AADa,CAAzB;AAGA,eAAehB,SAAf","sourcesContent":["import * as React from 'react';\nimport Statistic from './Statistic';\nimport { formatCountdown } from './utils';\nconst REFRESH_INTERVAL = 1000 / 30;\nfunction getTime(value) {\n    return new Date(value).getTime();\n}\nclass Countdown extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.syncTimer = () => {\n            const { value } = this.props;\n            const timestamp = getTime(value);\n            if (timestamp >= Date.now()) {\n                this.startTimer();\n            }\n            else {\n                this.stopTimer();\n            }\n        };\n        this.startTimer = () => {\n            if (this.countdownId)\n                return;\n            this.countdownId = window.setInterval(() => {\n                this.forceUpdate();\n            }, REFRESH_INTERVAL);\n        };\n        this.stopTimer = () => {\n            const { onFinish, value } = this.props;\n            if (this.countdownId) {\n                clearInterval(this.countdownId);\n                this.countdownId = undefined;\n                const timestamp = getTime(value);\n                if (onFinish && timestamp < Date.now()) {\n                    onFinish();\n                }\n            }\n        };\n        this.formatCountdown = (value, config) => {\n            const { format } = this.props;\n            return formatCountdown(value, Object.assign(Object.assign({}, config), { format }));\n        };\n        // Countdown do not need display the timestamp\n        this.valueRender = (node) => React.cloneElement(node, {\n            title: undefined,\n        });\n    }\n    componentDidMount() {\n        this.syncTimer();\n    }\n    componentDidUpdate() {\n        this.syncTimer();\n    }\n    componentWillUnmount() {\n        this.stopTimer();\n    }\n    render() {\n        return (<Statistic valueRender={this.valueRender} {...this.props} formatter={this.formatCountdown}/>);\n    }\n}\nCountdown.defaultProps = {\n    format: 'HH:mm:ss',\n};\nexport default Countdown;\n"],"file":"Countdown.js"}