{"version":3,"sources":["input/ResizableTextArea.jsx"],"names":["React","ResizeObserver","omit","classNames","calculateNodeHeight","raf","RESIZE_STATUS_NONE","RESIZE_STATUS_RESIZING","RESIZE_STATUS_RESIZED","ResizableTextArea","props","saveTextArea","textArea","handleResize","size","resizeStatus","state","autoSize","onResize","resizeOnNextFrame","cancel","nextFrameActionId","resizeTextarea","minRows","maxRows","textareaStyles","setState","resizeFrameId","renderTextArea","prefixCls","className","disabled","otherProps","cls","value","style","overflowX","overflowY","prevProps","Component"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport ResizeObserver from 'rc-resize-observer';\nimport omit from 'omit.js';\nimport classNames from 'classnames';\nimport calculateNodeHeight from './calculateNodeHeight';\nimport raf from '../_util/raf';\nconst RESIZE_STATUS_NONE = 0;\nconst RESIZE_STATUS_RESIZING = 1;\nconst RESIZE_STATUS_RESIZED = 2;\nclass ResizableTextArea extends React.Component {\n    constructor(props) {\n        super(props);\n        this.saveTextArea = (textArea) => {\n            this.textArea = textArea;\n        };\n        this.handleResize = (size) => {\n            const { resizeStatus } = this.state;\n            const { autoSize, onResize } = this.props;\n            if (resizeStatus !== RESIZE_STATUS_NONE) {\n                return;\n            }\n            if (typeof onResize === 'function') {\n                onResize(size);\n            }\n            if (autoSize) {\n                this.resizeOnNextFrame();\n            }\n        };\n        this.resizeOnNextFrame = () => {\n            raf.cancel(this.nextFrameActionId);\n            this.nextFrameActionId = raf(this.resizeTextarea);\n        };\n        this.resizeTextarea = () => {\n            const { autoSize } = this.props;\n            if (!autoSize || !this.textArea) {\n                return;\n            }\n            const { minRows, maxRows } = autoSize;\n            const textareaStyles = calculateNodeHeight(this.textArea, false, minRows, maxRows);\n            this.setState({ textareaStyles, resizeStatus: RESIZE_STATUS_RESIZING }, () => {\n                raf.cancel(this.resizeFrameId);\n                this.resizeFrameId = raf(() => {\n                    this.setState({ resizeStatus: RESIZE_STATUS_RESIZED }, () => {\n                        this.resizeFrameId = raf(() => {\n                            this.setState({ resizeStatus: RESIZE_STATUS_NONE });\n                        });\n                    });\n                });\n            });\n        };\n        this.renderTextArea = () => {\n            const { prefixCls, autoSize, onResize, className, disabled } = this.props;\n            const { textareaStyles, resizeStatus } = this.state;\n            const otherProps = omit(this.props, [\n                'prefixCls',\n                'onPressEnter',\n                'autoSize',\n                'defaultValue',\n                'allowClear',\n                'onResize',\n            ]);\n            const cls = classNames(prefixCls, className, {\n                [`${prefixCls}-disabled`]: disabled,\n            });\n            // Fix https://github.com/ant-design/ant-design/issues/6776\n            // Make sure it could be reset when using form.getFieldDecorator\n            if ('value' in otherProps) {\n                otherProps.value = otherProps.value || '';\n            }\n            const style = Object.assign(Object.assign(Object.assign({}, this.props.style), textareaStyles), (resizeStatus === RESIZE_STATUS_RESIZING\n                ? // React will warning when mix `overflow` & `overflowY`.\n                    // We need to define this separately.\n                    { overflowX: 'hidden', overflowY: 'hidden' }\n                : null));\n            return (<ResizeObserver onResize={this.handleResize} disabled={!(autoSize || onResize)}>\n        <textarea {...otherProps} className={cls} style={style} ref={this.saveTextArea}/>\n      </ResizeObserver>);\n        };\n        this.state = {\n            textareaStyles: {},\n            resizeStatus: RESIZE_STATUS_NONE,\n        };\n    }\n    componentDidMount() {\n        this.resizeTextarea();\n    }\n    componentDidUpdate(prevProps) {\n        // Re-render with the new content then recalculate the height as required.\n        if (prevProps.value !== this.props.value) {\n            this.resizeTextarea();\n        }\n    }\n    componentWillUnmount() {\n        raf.cancel(this.nextFrameActionId);\n        raf.cancel(this.resizeFrameId);\n    }\n    render() {\n        return this.renderTextArea();\n    }\n}\nexport default ResizableTextArea;\n"],"file":"ResizableTextArea.js"}