{"version":3,"sources":["calendar/generateCalendar.jsx"],"names":["React","classNames","padStart","PickerPanel","RCPickerPanel","LocaleReceiver","enUS","ConfigContext","CalendarHeader","generateCalendar","generateConfig","isSameMonth","date1","date2","getYear","getMonth","isSameDate","getDate","Calendar","props","customizePrefixCls","prefixCls","className","dateFullCellRender","dateCellRender","monthFullCellRender","monthCellRender","headerRender","value","defaultValue","disabledDate","mode","validRange","fullscreen","onChange","onPanelChange","onSelect","useContext","getPrefixCls","calendarPrefixCls","today","getNow","useState","innerValue","setInnerValue","mergedValue","innerMode","setInnerMode","mergedMode","panelMode","useMemo","mergedDisabledDate","date","isAfter","triggerPanelChange","newMode","triggerChange","triggerModeChange","onInternalSelect","getDefaultLocale","locale","result","lang","dateRender","useCallback","String","monthRender","months","shortMonths","getShortMonths","mergedLocale","type","onTypeChange"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport classNames from 'classnames';\nimport padStart from 'lodash/padStart';\nimport { PickerPanel as RCPickerPanel } from 'rc-picker';\nimport LocaleReceiver from '../locale-provider/LocaleReceiver';\nimport enUS from './locale/en_US';\nimport { ConfigContext } from '../config-provider';\nimport CalendarHeader from './Header';\nfunction generateCalendar(generateConfig) {\n    function isSameMonth(date1, date2) {\n        return (date1 === date2 ||\n            (date1 &&\n                date2 &&\n                generateConfig.getYear(date1) === generateConfig.getYear(date2) &&\n                generateConfig.getMonth(date1) === generateConfig.getMonth(date2)));\n    }\n    function isSameDate(date1, date2) {\n        return (isSameMonth(date1, date2) && generateConfig.getDate(date1) === generateConfig.getDate(date2));\n    }\n    const Calendar = (props) => {\n        const { prefixCls: customizePrefixCls, className, dateFullCellRender, dateCellRender, monthFullCellRender, monthCellRender, headerRender, value, defaultValue, disabledDate, mode, validRange, fullscreen = true, onChange, onPanelChange, onSelect, } = props;\n        const { getPrefixCls } = React.useContext(ConfigContext);\n        const prefixCls = getPrefixCls('picker', customizePrefixCls);\n        const calendarPrefixCls = `${prefixCls}-calendar`;\n        const today = generateConfig.getNow();\n        // ====================== State =======================\n        // Value\n        const [innerValue, setInnerValue] = React.useState(() => value || defaultValue || generateConfig.getNow());\n        const mergedValue = value || innerValue;\n        // Mode\n        const [innerMode, setInnerMode] = React.useState(() => mode || 'month');\n        const mergedMode = mode || innerMode;\n        const panelMode = React.useMemo(() => (mergedMode === 'year' ? 'month' : 'date'), [mergedMode]);\n        // Disabled Date\n        const mergedDisabledDate = React.useMemo(() => {\n            if (validRange) {\n                return (date) => {\n                    return (generateConfig.isAfter(validRange[0], date) ||\n                        generateConfig.isAfter(date, validRange[1]));\n                };\n            }\n            return disabledDate;\n        }, [disabledDate, validRange]);\n        // ====================== Events ======================\n        const triggerPanelChange = (date, newMode) => {\n            if (onPanelChange) {\n                onPanelChange(date, newMode);\n            }\n        };\n        const triggerChange = (date) => {\n            setInnerValue(date);\n            if (!isSameDate(date, mergedValue)) {\n                triggerPanelChange(date, mergedMode);\n                if (onChange) {\n                    onChange(date);\n                }\n            }\n        };\n        const triggerModeChange = (newMode) => {\n            setInnerMode(newMode);\n            triggerPanelChange(mergedValue, newMode);\n        };\n        const onInternalSelect = (date) => {\n            triggerChange(date);\n            if (onSelect) {\n                onSelect(date);\n            }\n        };\n        // ====================== Locale ======================\n        const getDefaultLocale = () => {\n            const { locale } = props;\n            const result = Object.assign(Object.assign({}, enUS), locale);\n            result.lang = Object.assign(Object.assign({}, result.lang), (locale || {}).lang);\n            return result;\n        };\n        // ====================== Render ======================\n        const dateRender = React.useCallback((date) => {\n            if (dateFullCellRender) {\n                return dateFullCellRender(date);\n            }\n            return (<div className={classNames(`${prefixCls}-cell-inner`, `${calendarPrefixCls}-date`, {\n                [`${calendarPrefixCls}-date-today`]: isSameDate(today, date),\n            })}>\n            <div className={`${calendarPrefixCls}-date-value`}>\n              {padStart(String(generateConfig.getDate(date)), 2, '0')}\n            </div>\n            <div className={`${calendarPrefixCls}-date-content`}>\n              {dateCellRender && dateCellRender(date)}\n            </div>\n          </div>);\n        }, [dateFullCellRender, dateCellRender]);\n        const monthRender = React.useCallback((date, locale) => {\n            if (monthFullCellRender) {\n                return monthFullCellRender(date);\n            }\n            const months = locale.shortMonths || generateConfig.locale.getShortMonths(locale.locale);\n            return (<div className={classNames(`${prefixCls}-cell-inner`, `${calendarPrefixCls}-date`, {\n                [`${calendarPrefixCls}-date-today`]: isSameMonth(today, date),\n            })}>\n            <div className={`${calendarPrefixCls}-date-value`}>\n              {months[generateConfig.getMonth(date)]}\n            </div>\n            <div className={`${calendarPrefixCls}-date-content`}>\n              {monthCellRender && monthCellRender(date)}\n            </div>\n          </div>);\n        }, [monthFullCellRender, monthCellRender]);\n        return (<LocaleReceiver componentName=\"Calendar\" defaultLocale={getDefaultLocale}>\n        {(mergedLocale) => {\n            return (<div className={classNames(calendarPrefixCls, className, {\n                [`${calendarPrefixCls}-full`]: fullscreen,\n                [`${calendarPrefixCls}-mini`]: !fullscreen,\n            })}>\n              {headerRender ? (headerRender({\n                value: mergedValue,\n                type: mergedMode,\n                onChange: onInternalSelect,\n                onTypeChange: triggerModeChange,\n            })) : (<CalendarHeader prefixCls={calendarPrefixCls} value={mergedValue} generateConfig={generateConfig} mode={mergedMode} fullscreen={fullscreen} locale={mergedLocale.lang} validRange={validRange} onChange={onInternalSelect} onModeChange={triggerModeChange}/>)}\n\n              <RCPickerPanel value={mergedValue} prefixCls={prefixCls} locale={mergedLocale.lang} generateConfig={generateConfig} dateRender={dateRender} monthCellRender={date => monthRender(date, mergedLocale.lang)} onSelect={onInternalSelect} mode={panelMode} picker={panelMode} disabledDate={mergedDisabledDate} hideHeader/>\n            </div>);\n        }}\n      </LocaleReceiver>);\n    };\n    return Calendar;\n}\nexport default generateCalendar;\n"],"file":"generateCalendar.js"}