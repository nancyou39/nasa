{"version":3,"sources":["table/hooks/useSelection.jsx"],"names":["EMPTY_LIST","SELECTION_ALL","SELECTION_INVERT","getFixedType","column","fixed","flattenData","data","childrenColumnName","list","forEach","record","push","useSelection","rowSelection","config","selectedRowKeys","getCheckboxProps","onSelectionChange","onChange","onSelect","onSelectAll","onSelectInvert","onSelectMultiple","columnWidth","selectionColWidth","selectionType","type","selections","prefixCls","pageData","getRecordByKey","getRowKey","expandType","tableLocale","locale","expandIconColumnIndex","React","useState","innerSelectedKeys","setInnerSelectedKeys","mergedSelectedKeys","mergedSelectedKeySet","useMemo","keys","slice","Set","lastSelectedKey","setLastSelectedKey","useEffect","setSelectedKeys","useCallback","records","map","key","triggerSingleSelection","selected","event","rows","k","mergedSelections","selectionList","selection","text","selectionAll","index","selectInvert","keySet","has","add","Array","from","transformColumns","columns","flattedData","checkboxPropsMap","Map","checkboxProps","set","process","env","NODE_ENV","recordKeys","filter","get","disabled","checkedCurrentAll","every","checkedCurrentSome","some","onSelectAllChange","changeKeys","title","customizeSelections","menu","onSelectionClick","allDisabled","length","renderCell","_","nativeEvent","hasKey","shiftKey","startIndex","endIndex","pointKeys","recordKey","recordIndex","rangeKeys","changedKeys","selectionColumn","width","className","columnTitle","render","expandColumn","restColumns"],"mappings":";;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,IAAMA,UAAU,GAAG,EAAnB,C,CACA;;AACO,IAAMC,aAAa,GAAG,YAAtB;;AACA,IAAMC,gBAAgB,GAAG,eAAzB;;;AACP,SAASC,YAAT,CAAsBC,MAAtB,EAA8B;AAC1B,SAAOA,MAAM,IAAIA,MAAM,CAACC,KAAxB;AACH;;AACD,SAASC,WAAT,CAAqBC,IAArB,EAA2BC,kBAA3B,EAA+C;AAC3C,MAAIC,IAAI,GAAG,EAAX;AACA,GAACF,IAAI,IAAI,EAAT,EAAaG,OAAb,CAAqB,UAAAC,MAAM,EAAI;AAC3BF,IAAAA,IAAI,CAACG,IAAL,CAAUD,MAAV;;AACA,QAAIH,kBAAkB,IAAIG,MAA1B,EAAkC;AAC9BF,MAAAA,IAAI,gCACGA,IADH,sBAEGH,WAAW,CAACK,MAAM,CAACH,kBAAD,CAAP,EAA6BA,kBAA7B,CAFd,EAAJ;AAIH;AACJ,GARD;AASA,SAAOC,IAAP;AACH;;AACc,SAASI,YAAT,CAAsBC,YAAtB,EAAoCC,MAApC,EAA4C;AAAA,aAC2JD,YAAY,IAAI,EAD3K;AAAA,MAC/CE,eAD+C,QAC/CA,eAD+C;AAAA,MAC9BC,gBAD8B,QAC9BA,gBAD8B;AAAA,MACFC,iBADE,QACZC,QADY;AAAA,MACiBC,QADjB,QACiBA,QADjB;AAAA,MAC2BC,WAD3B,QAC2BA,WAD3B;AAAA,MACwCC,cADxC,QACwCA,cADxC;AAAA,MACwDC,gBADxD,QACwDA,gBADxD;AAAA,8BAC0EC,WAD1E;AAAA,MACuFC,iBADvF,iCAC2G,EAD3G;AAAA,MACqHC,aADrH,QAC+GC,IAD/G;AAAA,MACoIC,UADpI,QACoIA,UADpI;AAAA,MACgJvB,KADhJ,QACgJA,KADhJ;;AAAA,MAE/CwB,SAF+C,GAEuFd,MAFvF,CAE/Cc,SAF+C;AAAA,MAEpCtB,IAFoC,GAEuFQ,MAFvF,CAEpCR,IAFoC;AAAA,MAE9BuB,QAF8B,GAEuFf,MAFvF,CAE9Be,QAF8B;AAAA,MAEpBC,cAFoB,GAEuFhB,MAFvF,CAEpBgB,cAFoB;AAAA,MAEJC,SAFI,GAEuFjB,MAFvF,CAEJiB,SAFI;AAAA,MAEOC,UAFP,GAEuFlB,MAFvF,CAEOkB,UAFP;AAAA,MAEmBzB,kBAFnB,GAEuFO,MAFvF,CAEmBP,kBAFnB;AAAA,MAE+C0B,WAF/C,GAEuFnB,MAFvF,CAEuCoB,MAFvC;AAAA,MAE4DC,qBAF5D,GAEuFrB,MAFvF,CAE4DqB,qBAF5D;;AAAA,wBAGLC,KAAK,CAACC,QAAN,EAHK;AAAA;AAAA,MAGhDC,iBAHgD;AAAA,MAG7BC,oBAH6B;;AAIvD,MAAMC,kBAAkB,GAAGzB,eAAe,IAAIuB,iBAAnB,IAAwCvC,UAAnE;AACA,MAAM0C,oBAAoB,GAAGL,KAAK,CAACM,OAAN,CAAc,YAAM;AAC7C,QAAMC,IAAI,GAAGlB,aAAa,KAAK,OAAlB,GAA4Be,kBAAkB,CAACI,KAAnB,CAAyB,CAAzB,EAA4B,CAA5B,CAA5B,GAA6DJ,kBAA1E;AACA,WAAO,IAAIK,GAAJ,CAAQF,IAAR,CAAP;AACH,GAH4B,EAG1B,CAACH,kBAAD,EAAqBf,aAArB,CAH0B,CAA7B,CALuD,CASvD;;AATuD,yBAUTW,KAAK,CAACC,QAAN,CAAe,IAAf,CAVS;AAAA;AAAA,MAUhDS,eAVgD;AAAA,MAU/BC,kBAV+B,wBAWvD;;;AACAX,EAAAA,KAAK,CAACY,SAAN,CAAgB,YAAM;AAClB,QAAI,CAACnC,YAAL,EAAmB;AACf0B,MAAAA,oBAAoB,CAAC,EAAD,CAApB;AACH;AACJ,GAJD,EAIG,CAAC,CAAC,CAAC1B,YAAH,CAJH;AAKA,MAAMoC,eAAe,GAAGb,KAAK,CAACc,WAAN,CAAkB,UAACP,IAAD,EAAU;AAChDJ,IAAAA,oBAAoB,CAACI,IAAD,CAApB;AACA,QAAMQ,OAAO,GAAGR,IAAI,CAACS,GAAL,CAAS,UAAAC,GAAG;AAAA,aAAIvB,cAAc,CAACuB,GAAD,CAAlB;AAAA,KAAZ,CAAhB;;AACA,QAAIpC,iBAAJ,EAAuB;AACnBA,MAAAA,iBAAiB,CAAC0B,IAAD,EAAOQ,OAAP,CAAjB;AACH;AACJ,GANuB,EAMrB,CAACZ,oBAAD,EAAuBT,cAAvB,EAAuCb,iBAAvC,CANqB,CAAxB,CAjBuD,CAwBvD;;AACA,MAAMqC,sBAAsB,GAAGlB,KAAK,CAACc,WAAN,CAAkB,UAACG,GAAD,EAAME,QAAN,EAAgBZ,IAAhB,EAAsBa,KAAtB,EAAgC;AAC7E,QAAIrC,QAAJ,EAAc;AACV,UAAMsC,IAAI,GAAGd,IAAI,CAACS,GAAL,CAAS,UAAAM,CAAC;AAAA,eAAI5B,cAAc,CAAC4B,CAAD,CAAlB;AAAA,OAAV,CAAb;AACAvC,MAAAA,QAAQ,CAACW,cAAc,CAACuB,GAAD,CAAf,EAAsBE,QAAtB,EAAgCE,IAAhC,EAAsCD,KAAtC,CAAR;AACH;;AACDP,IAAAA,eAAe,CAACN,IAAD,CAAf;AACH,GAN8B,EAM5B,CAACxB,QAAD,EAAWW,cAAX,EAA2BmB,eAA3B,CAN4B,CAA/B;AAOA,MAAMU,gBAAgB,GAAGvB,KAAK,CAACM,OAAN,CAAc,YAAM;AACzC,QAAI,CAACf,UAAL,EAAiB;AACb,aAAO,IAAP;AACH;;AACD,QAAMiC,aAAa,GAAGjC,UAAU,KAAK,IAAf,GAAsB,CAAC3B,aAAD,EAAgBC,gBAAhB,CAAtB,GAA0D0B,UAAhF;AACA,WAAOiC,aAAa,CAACR,GAAd,CAAkB,UAACS,SAAD,EAAe;AACpC,UAAIA,SAAS,KAAK7D,aAAlB,EAAiC;AAC7B,eAAO;AACHqD,UAAAA,GAAG,EAAE,KADF;AAEHS,UAAAA,IAAI,EAAE7B,WAAW,CAAC8B,YAFf;AAGH5C,UAAAA,QAHG,sBAGQ;AACP8B,YAAAA,eAAe,CAAC3C,IAAI,CAAC8C,GAAL,CAAS,UAAC1C,MAAD,EAASsD,KAAT;AAAA,qBAAmBjC,SAAS,CAACrB,MAAD,EAASsD,KAAT,CAA5B;AAAA,aAAT,CAAD,CAAf;AACH;AALE,SAAP;AAOH;;AACD,UAAIH,SAAS,KAAK5D,gBAAlB,EAAoC;AAChC,eAAO;AACHoD,UAAAA,GAAG,EAAE,QADF;AAEHS,UAAAA,IAAI,EAAE7B,WAAW,CAACgC,YAFf;AAGH9C,UAAAA,QAHG,sBAGQ;AACP,gBAAM+C,MAAM,GAAG,IAAIrB,GAAJ,CAAQJ,oBAAR,CAAf;AACAZ,YAAAA,QAAQ,CAACpB,OAAT,CAAiB,UAACC,MAAD,EAASsD,KAAT,EAAmB;AAChC,kBAAMX,GAAG,GAAGtB,SAAS,CAACrB,MAAD,EAASsD,KAAT,CAArB;;AACA,kBAAIE,MAAM,CAACC,GAAP,CAAWd,GAAX,CAAJ,EAAqB;AACjBa,gBAAAA,MAAM,UAAN,CAAcb,GAAd;AACH,eAFD,MAGK;AACDa,gBAAAA,MAAM,CAACE,GAAP,CAAWf,GAAX;AACH;AACJ,aARD;AASA,gBAAMV,IAAI,GAAG0B,KAAK,CAACC,IAAN,CAAWJ,MAAX,CAAb;AACAjB,YAAAA,eAAe,CAACN,IAAD,CAAf;;AACA,gBAAItB,cAAJ,EAAoB;AAChB,uCAAQ,KAAR,EAAe,OAAf,EAAwB,4EAAxB;AACAA,cAAAA,cAAc,CAACsB,IAAD,CAAd;AACH;AACJ;AApBE,SAAP;AAsBH;;AACD,aAAOkB,SAAP;AACH,KAnCM,CAAP;AAoCH,GAzCwB,EAyCtB,CAAClC,UAAD,EAAac,oBAAb,EAAmCZ,QAAnC,EAA6CE,SAA7C,CAzCsB,CAAzB;AA0CA,MAAMwC,gBAAgB,GAAGnC,KAAK,CAACc,WAAN,CAAkB,UAACsB,OAAD,EAAa;AACpD,QAAI,CAAC3D,YAAL,EAAmB;AACf,aAAO2D,OAAP;AACH,KAHmD,CAIpD;;;AACA,QAAMC,WAAW,GAAGpE,WAAW,CAACwB,QAAD,EAAWtB,kBAAX,CAA/B,CALoD,CAMpD;;AACA,QAAM2D,MAAM,GAAG,IAAIrB,GAAJ,CAAQJ,oBAAR,CAAf,CAPoD,CAQpD;;AACA,QAAMiC,gBAAgB,GAAG,IAAIC,GAAJ,EAAzB;AACAF,IAAAA,WAAW,CAAChE,OAAZ,CAAoB,UAACC,MAAD,EAASsD,KAAT,EAAmB;AACnC,UAAMX,GAAG,GAAGtB,SAAS,CAACrB,MAAD,EAASsD,KAAT,CAArB;AACA,UAAMY,aAAa,GAAG,CAAC5D,gBAAgB,GAAGA,gBAAgB,CAACN,MAAD,CAAnB,GAA8B,IAA/C,KAAwD,EAA9E;AACAgE,MAAAA,gBAAgB,CAACG,GAAjB,CAAqBxB,GAArB,EAA0BuB,aAA1B;;AACA,UAAIE,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,KACC,aAAaJ,aAAb,IAA8B,oBAAoBA,aADnD,CAAJ,EACuE;AACnE,iCAAQ,KAAR,EAAe,OAAf,EAAwB,uGAAxB;AACH;AACJ,KARD,EAVoD,CAmBpD;;AACA,QAAMK,UAAU,GAAGR,WAAW,CACzBrB,GADc,CACVrB,SADU,EAEdmD,MAFc,CAEP,UAAA7B,GAAG;AAAA,aAAI,CAACqB,gBAAgB,CAACS,GAAjB,CAAqB9B,GAArB,EAA0B+B,QAA/B;AAAA,KAFI,CAAnB;AAGA,QAAMC,iBAAiB,GAAGJ,UAAU,CAACK,KAAX,CAAiB,UAAAjC,GAAG;AAAA,aAAIa,MAAM,CAACC,GAAP,CAAWd,GAAX,CAAJ;AAAA,KAApB,CAA1B;AACA,QAAMkC,kBAAkB,GAAGN,UAAU,CAACO,IAAX,CAAgB,UAAAnC,GAAG;AAAA,aAAIa,MAAM,CAACC,GAAP,CAAWd,GAAX,CAAJ;AAAA,KAAnB,CAA3B;;AACA,QAAMoC,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;AAC5B,UAAMC,UAAU,GAAG,EAAnB;;AACA,UAAIL,iBAAJ,EAAuB;AACnBJ,QAAAA,UAAU,CAACxE,OAAX,CAAmB,UAAA4C,GAAG,EAAI;AACtBa,UAAAA,MAAM,UAAN,CAAcb,GAAd;AACAqC,UAAAA,UAAU,CAAC/E,IAAX,CAAgB0C,GAAhB;AACH,SAHD;AAIH,OALD,MAMK;AACD4B,QAAAA,UAAU,CAACxE,OAAX,CAAmB,UAAA4C,GAAG,EAAI;AACtBa,UAAAA,MAAM,CAACE,GAAP,CAAWf,GAAX;AACAqC,UAAAA,UAAU,CAAC/E,IAAX,CAAgB0C,GAAhB;AACH,SAHD;AAIH;;AACD,UAAMV,IAAI,GAAG0B,KAAK,CAACC,IAAN,CAAWJ,MAAX,CAAb;AACAjB,MAAAA,eAAe,CAACN,IAAD,CAAf;;AACA,UAAIvB,WAAJ,EAAiB;AACbA,QAAAA,WAAW,CAAC,CAACiE,iBAAF,EAAqB1C,IAAI,CAACS,GAAL,CAAS,UAAAM,CAAC;AAAA,iBAAI5B,cAAc,CAAC4B,CAAD,CAAlB;AAAA,SAAV,CAArB,EAAuDgC,UAAU,CAACtC,GAAX,CAAe,UAAAM,CAAC;AAAA,iBAAI5B,cAAc,CAAC4B,CAAD,CAAlB;AAAA,SAAhB,CAAvD,CAAX;AACH;AACJ,KAnBD,CAzBoD,CA6CpD;AACA;;;AACA,QAAIiC,KAAJ;;AACA,QAAIlE,aAAa,KAAK,OAAtB,EAA+B;AAC3B,UAAImE,mBAAJ;;AACA,UAAIjC,gBAAJ,EAAsB;AAClB,YAAMkC,IAAI,GAAI,oBAAC,gBAAD,QACflC,gBAAgB,CAACP,GAAjB,CAAqB,UAACS,SAAD,EAAYG,KAAZ,EAAsB;AAAA,cAC9BX,GAD8B,GACYQ,SADZ,CAC9BR,GAD8B;AAAA,cACzBS,IADyB,GACYD,SADZ,CACzBC,IADyB;AAAA,cACTgC,gBADS,GACYjC,SADZ,CACnB1C,QADmB;AAEtC,iBAAQ,oBAAC,gBAAD,CAAM,IAAN;AAAW,YAAA,GAAG,EAAEkC,GAAG,IAAIW,KAAvB;AAA8B,YAAA,OAAO,EAAE,mBAAM;AACjD,kBAAI8B,gBAAJ,EAAsB;AAClBA,gBAAAA,gBAAgB,CAACb,UAAD,CAAhB;AACH;AACJ;AAJO,aAKPnB,IALO,CAAR;AAOH,SATF,CADe,CAAd;AAYA8B,QAAAA,mBAAmB,GAAI;AAAK,UAAA,SAAS,YAAKhE,SAAL;AAAd,WACzB,oBAAC,oBAAD;AAAU,UAAA,OAAO,EAAEiE;AAAnB,WACE,kCACE,oBAAC,wBAAD,OADF,CADF,CADyB,CAAvB;AAOH;;AACD,UAAME,WAAW,GAAGtB,WAAW,CAACa,KAAZ,CAAkB,UAAC5E,MAAD,EAASsD,KAAT,EAAmB;AACrD,YAAMX,GAAG,GAAGtB,SAAS,CAACrB,MAAD,EAASsD,KAAT,CAArB;AACA,YAAMY,aAAa,GAAGF,gBAAgB,CAACS,GAAjB,CAAqB9B,GAArB,KAA6B,EAAnD;AACA,eAAOuB,aAAa,CAACQ,QAArB;AACH,OAJmB,CAApB;AAKAO,MAAAA,KAAK,GAAI;AAAK,QAAA,SAAS,YAAK/D,SAAL;AAAd,SACT,oBAAC,oBAAD;AAAU,QAAA,OAAO,EAAE,CAACmE,WAAD,IAAgB,CAAC,CAACtB,WAAW,CAACuB,MAA9B,IAAwCX,iBAA3D;AAA8E,QAAA,aAAa,EAAE,CAACA,iBAAD,IAAsBE,kBAAnH;AAAuI,QAAA,QAAQ,EAAEE,iBAAjJ;AAAoK,QAAA,QAAQ,EAAEhB,WAAW,CAACuB,MAAZ,KAAuB,CAAvB,IAA4BD;AAA1M,QADS,EAERH,mBAFQ,CAAT;AAIH,KAhFmD,CAiFpD;;;AACA,QAAIK,UAAJ;;AACA,QAAIxE,aAAa,KAAK,OAAtB,EAA+B;AAC3BwE,MAAAA,UAAU,GAAG,oBAACC,CAAD,EAAIxF,MAAJ,EAAYsD,KAAZ,EAAsB;AAC/B,YAAMX,GAAG,GAAGtB,SAAS,CAACrB,MAAD,EAASsD,KAAT,CAArB;AACA,eAAQ,oBAAC,iBAAD,eAAWU,gBAAgB,CAACS,GAAjB,CAAqB9B,GAArB,CAAX;AAAsC,UAAA,OAAO,EAAEa,MAAM,CAACC,GAAP,CAAWd,GAAX,CAA/C;AAAgE,UAAA,QAAQ,EAAE,kBAAAG,KAAK,EAAI;AACvF,gBAAI,CAACU,MAAM,CAACC,GAAP,CAAWd,GAAX,CAAL,EAAsB;AAClBC,cAAAA,sBAAsB,CAACD,GAAD,EAAM,IAAN,EAAY,CAACA,GAAD,CAAZ,EAAmBG,KAAK,CAAC2C,WAAzB,CAAtB;AACH;AACJ;AAJO,WAAR;AAKH,OAPD;AAQH,KATD,MAUK;AACDF,MAAAA,UAAU,GAAG,oBAACC,CAAD,EAAIxF,MAAJ,EAAYsD,KAAZ,EAAsB;AAC/B,YAAMX,GAAG,GAAGtB,SAAS,CAACrB,MAAD,EAASsD,KAAT,CAArB;AACA,YAAMoC,MAAM,GAAGlC,MAAM,CAACC,GAAP,CAAWd,GAAX,CAAf,CAF+B,CAG/B;;AACA,eAAQ,oBAAC,oBAAD,eAAcqB,gBAAgB,CAACS,GAAjB,CAAqB9B,GAArB,CAAd;AAAyC,UAAA,OAAO,EAAE+C,MAAlD;AAA0D,UAAA,QAAQ,EAAE,yBAAqB;AAAA,gBAAlBD,WAAkB,SAAlBA,WAAkB;AAAA,gBACrFE,QADqF,GACxEF,WADwE,CACrFE,QADqF;AAE7F,gBAAIC,UAAU,GAAG,CAAC,CAAlB;AACA,gBAAIC,QAAQ,GAAG,CAAC,CAAhB,CAH6F,CAI7F;;AACA,gBAAIF,QAAJ,EAAc;AACV,kBAAMG,SAAS,GAAG,IAAI3D,GAAJ,CAAQ,CAACC,eAAD,EAAkBO,GAAlB,CAAR,CAAlB;AACA4B,cAAAA,UAAU,CAACO,IAAX,CAAgB,UAACiB,SAAD,EAAYC,WAAZ,EAA4B;AACxC,oBAAIF,SAAS,CAACrC,GAAV,CAAcsC,SAAd,CAAJ,EAA8B;AAC1B,sBAAIH,UAAU,KAAK,CAAC,CAApB,EAAuB;AACnBA,oBAAAA,UAAU,GAAGI,WAAb;AACH,mBAFD,MAGK;AACDH,oBAAAA,QAAQ,GAAGG,WAAX;AACA,2BAAO,IAAP;AACH;AACJ;;AACD,uBAAO,KAAP;AACH,eAXD;AAYH;;AACD,gBAAIH,QAAQ,KAAK,CAAC,CAAd,IAAmBD,UAAU,KAAKC,QAAtC,EAAgD;AAC5C;AACA,kBAAMI,SAAS,GAAG1B,UAAU,CAACrC,KAAX,CAAiB0D,UAAjB,EAA6BC,QAAQ,GAAG,CAAxC,CAAlB;AACA,kBAAMK,WAAW,GAAG,EAApB;;AACA,kBAAIR,MAAJ,EAAY;AACRO,gBAAAA,SAAS,CAAClG,OAAV,CAAkB,UAAAgG,SAAS,EAAI;AAC3B,sBAAIvC,MAAM,CAACC,GAAP,CAAWsC,SAAX,CAAJ,EAA2B;AACvBG,oBAAAA,WAAW,CAACjG,IAAZ,CAAiB8F,SAAjB;AACAvC,oBAAAA,MAAM,UAAN,CAAcuC,SAAd;AACH;AACJ,iBALD;AAMH,eAPD,MAQK;AACDE,gBAAAA,SAAS,CAAClG,OAAV,CAAkB,UAAAgG,SAAS,EAAI;AAC3B,sBAAI,CAACvC,MAAM,CAACC,GAAP,CAAWsC,SAAX,CAAL,EAA4B;AACxBG,oBAAAA,WAAW,CAACjG,IAAZ,CAAiB8F,SAAjB;AACAvC,oBAAAA,MAAM,CAACE,GAAP,CAAWqC,SAAX;AACH;AACJ,iBALD;AAMH;;AACD,kBAAM9D,IAAI,GAAG0B,KAAK,CAACC,IAAN,CAAWJ,MAAX,CAAb;AACAjB,cAAAA,eAAe,CAACN,IAAD,CAAf;;AACA,kBAAIrB,gBAAJ,EAAsB;AAClBA,gBAAAA,gBAAgB,CAAC,CAAC8E,MAAF,EAAUzD,IAAI,CAACS,GAAL,CAAS,UAAAqD,SAAS;AAAA,yBAAI3E,cAAc,CAAC2E,SAAD,CAAlB;AAAA,iBAAlB,CAAV,EAA4DG,WAAW,CAACxD,GAAZ,CAAgB,UAAAqD,SAAS;AAAA,yBAAI3E,cAAc,CAAC2E,SAAD,CAAlB;AAAA,iBAAzB,CAA5D,CAAhB;AACH;AACJ,aAzBD,MA0BK;AACD;AACA,kBAAIL,MAAJ,EAAY;AACRlC,gBAAAA,MAAM,UAAN,CAAcb,GAAd;AACH,eAFD,MAGK;AACDa,gBAAAA,MAAM,CAACE,GAAP,CAAWf,GAAX;AACH;;AACDC,cAAAA,sBAAsB,CAACD,GAAD,EAAM,CAAC+C,MAAP,EAAe/B,KAAK,CAACC,IAAN,CAAWJ,MAAX,CAAf,EAAmCiC,WAAnC,CAAtB;AACH;;AACDpD,YAAAA,kBAAkB,CAACM,GAAD,CAAlB;AACH;AAzDO,WAAR;AA0DH,OA9DD;AA+DH,KA7JmD,CA8JpD;;;AACA,QAAMwD,eAAe,GAAG;AACpBC,MAAAA,KAAK,EAAEtF,iBADa;AAEpBuF,MAAAA,SAAS,YAAKnF,SAAL,sBAFW;AAGpB+D,MAAAA,KAAK,EAAE9E,YAAY,CAACmG,WAAb,IAA4BrB,KAHf;AAIpBsB,MAAAA,MAAM,EAAEhB;AAJY,KAAxB;;AAMA,QAAIjE,UAAU,KAAK,KAAf,IAAwBwC,OAAO,CAACwB,MAAhC,IAA0C,CAAC7D,qBAA/C,EAAsE;AAAA,8BAC3BqC,OAD2B;AAAA,UAC3D0C,YAD2D;AAAA,UAC1CC,WAD0C;;AAElE,cACID,YADJ,EAEI,SAAc,SAAc,EAAd,EAAkBL,eAAlB,CAAd,EAAkD;AAAEzG,QAAAA,KAAK,EAAEA,KAAK,IAAIF,YAAY,CAACiH,WAAW,CAAC,CAAD,CAAZ;AAA9B,OAAlD,CAFJ,4BAGOA,WAHP;AAKH;;AACD,YAAQ,SAAc,SAAc,EAAd,EAAkBN,eAAlB,CAAd,EAAkD;AAAEzG,MAAAA,KAAK,EAAEA,KAAK,IAAIF,YAAY,CAACsE,OAAO,CAAC,CAAD,CAAR;AAA9B,KAAlD,CAAR,4BAA4GA,OAA5G;AACH,GA9KwB,EA8KtB,CACCzC,SADD,EAECF,QAFD,EAGChB,YAHD,EAICyB,iBAJD,EAKCE,kBALD,EAMChB,iBAND,EAOCmC,gBAPD,EAQC3B,UARD,EASCc,eATD,EAUCxB,gBAVD,EAWCgC,sBAXD,CA9KsB,CAAzB;AA2LA,SAAO,CAACiB,gBAAD,EAAmB9B,oBAAnB,CAAP;AACH","sourcesContent":["import * as React from 'react';\nimport DownOutlined from '@ant-design/icons/DownOutlined';\nimport Checkbox from '../../checkbox';\nimport Dropdown from '../../dropdown';\nimport Menu from '../../menu';\nimport Radio from '../../radio';\nimport warning from '../../_util/warning';\nconst EMPTY_LIST = [];\n// TODO: warning if use ajax!!!\nexport const SELECTION_ALL = 'SELECT_ALL';\nexport const SELECTION_INVERT = 'SELECT_INVERT';\nfunction getFixedType(column) {\n    return column && column.fixed;\n}\nfunction flattenData(data, childrenColumnName) {\n    let list = [];\n    (data || []).forEach(record => {\n        list.push(record);\n        if (childrenColumnName in record) {\n            list = [\n                ...list,\n                ...flattenData(record[childrenColumnName], childrenColumnName),\n            ];\n        }\n    });\n    return list;\n}\nexport default function useSelection(rowSelection, config) {\n    const { selectedRowKeys, getCheckboxProps, onChange: onSelectionChange, onSelect, onSelectAll, onSelectInvert, onSelectMultiple, columnWidth: selectionColWidth = 60, type: selectionType, selections, fixed, } = rowSelection || {};\n    const { prefixCls, data, pageData, getRecordByKey, getRowKey, expandType, childrenColumnName, locale: tableLocale, expandIconColumnIndex, } = config;\n    const [innerSelectedKeys, setInnerSelectedKeys] = React.useState();\n    const mergedSelectedKeys = selectedRowKeys || innerSelectedKeys || EMPTY_LIST;\n    const mergedSelectedKeySet = React.useMemo(() => {\n        const keys = selectionType === 'radio' ? mergedSelectedKeys.slice(0, 1) : mergedSelectedKeys;\n        return new Set(keys);\n    }, [mergedSelectedKeys, selectionType]);\n    // Save last selected key to enable range selection\n    const [lastSelectedKey, setLastSelectedKey] = React.useState(null);\n    // Reset if rowSelection reset\n    React.useEffect(() => {\n        if (!rowSelection) {\n            setInnerSelectedKeys([]);\n        }\n    }, [!!rowSelection]);\n    const setSelectedKeys = React.useCallback((keys) => {\n        setInnerSelectedKeys(keys);\n        const records = keys.map(key => getRecordByKey(key));\n        if (onSelectionChange) {\n            onSelectionChange(keys, records);\n        }\n    }, [setInnerSelectedKeys, getRecordByKey, onSelectionChange]);\n    // Trigger single `onSelect` event\n    const triggerSingleSelection = React.useCallback((key, selected, keys, event) => {\n        if (onSelect) {\n            const rows = keys.map(k => getRecordByKey(k));\n            onSelect(getRecordByKey(key), selected, rows, event);\n        }\n        setSelectedKeys(keys);\n    }, [onSelect, getRecordByKey, setSelectedKeys]);\n    const mergedSelections = React.useMemo(() => {\n        if (!selections) {\n            return null;\n        }\n        const selectionList = selections === true ? [SELECTION_ALL, SELECTION_INVERT] : selections;\n        return selectionList.map((selection) => {\n            if (selection === SELECTION_ALL) {\n                return {\n                    key: 'all',\n                    text: tableLocale.selectionAll,\n                    onSelect() {\n                        setSelectedKeys(data.map((record, index) => getRowKey(record, index)));\n                    },\n                };\n            }\n            if (selection === SELECTION_INVERT) {\n                return {\n                    key: 'invert',\n                    text: tableLocale.selectInvert,\n                    onSelect() {\n                        const keySet = new Set(mergedSelectedKeySet);\n                        pageData.forEach((record, index) => {\n                            const key = getRowKey(record, index);\n                            if (keySet.has(key)) {\n                                keySet.delete(key);\n                            }\n                            else {\n                                keySet.add(key);\n                            }\n                        });\n                        const keys = Array.from(keySet);\n                        setSelectedKeys(keys);\n                        if (onSelectInvert) {\n                            warning(false, 'Table', '`onSelectInvert` will be removed in future. Please use `onChange` instead.');\n                            onSelectInvert(keys);\n                        }\n                    },\n                };\n            }\n            return selection;\n        });\n    }, [selections, mergedSelectedKeySet, pageData, getRowKey]);\n    const transformColumns = React.useCallback((columns) => {\n        if (!rowSelection) {\n            return columns;\n        }\n        // Get flatten data\n        const flattedData = flattenData(pageData, childrenColumnName);\n        // Support selection\n        const keySet = new Set(mergedSelectedKeySet);\n        // Get all checkbox props\n        const checkboxPropsMap = new Map();\n        flattedData.forEach((record, index) => {\n            const key = getRowKey(record, index);\n            const checkboxProps = (getCheckboxProps ? getCheckboxProps(record) : null) || {};\n            checkboxPropsMap.set(key, checkboxProps);\n            if (process.env.NODE_ENV !== 'production' &&\n                ('checked' in checkboxProps || 'defaultChecked' in checkboxProps)) {\n                warning(false, 'Table', 'Do not set `checked` or `defaultChecked` in `getCheckboxProps`. Please use `selectedRowKeys` instead.');\n            }\n        });\n        // Record key only need check with enabled\n        const recordKeys = flattedData\n            .map(getRowKey)\n            .filter(key => !checkboxPropsMap.get(key).disabled);\n        const checkedCurrentAll = recordKeys.every(key => keySet.has(key));\n        const checkedCurrentSome = recordKeys.some(key => keySet.has(key));\n        const onSelectAllChange = () => {\n            const changeKeys = [];\n            if (checkedCurrentAll) {\n                recordKeys.forEach(key => {\n                    keySet.delete(key);\n                    changeKeys.push(key);\n                });\n            }\n            else {\n                recordKeys.forEach(key => {\n                    keySet.add(key);\n                    changeKeys.push(key);\n                });\n            }\n            const keys = Array.from(keySet);\n            setSelectedKeys(keys);\n            if (onSelectAll) {\n                onSelectAll(!checkedCurrentAll, keys.map(k => getRecordByKey(k)), changeKeys.map(k => getRecordByKey(k)));\n            }\n        };\n        // ===================== Render =====================\n        // Title Cell\n        let title;\n        if (selectionType !== 'radio') {\n            let customizeSelections;\n            if (mergedSelections) {\n                const menu = (<Menu>\n              {mergedSelections.map((selection, index) => {\n                    const { key, text, onSelect: onSelectionClick } = selection;\n                    return (<Menu.Item key={key || index} onClick={() => {\n                        if (onSelectionClick) {\n                            onSelectionClick(recordKeys);\n                        }\n                    }}>\n                    {text}\n                  </Menu.Item>);\n                })}\n            </Menu>);\n                customizeSelections = (<div className={`${prefixCls}-selection-extra`}>\n              <Dropdown overlay={menu}>\n                <span>\n                  <DownOutlined />\n                </span>\n              </Dropdown>\n            </div>);\n            }\n            const allDisabled = flattedData.every((record, index) => {\n                const key = getRowKey(record, index);\n                const checkboxProps = checkboxPropsMap.get(key) || {};\n                return checkboxProps.disabled;\n            });\n            title = (<div className={`${prefixCls}-selection`}>\n            <Checkbox checked={!allDisabled && !!flattedData.length && checkedCurrentAll} indeterminate={!checkedCurrentAll && checkedCurrentSome} onChange={onSelectAllChange} disabled={flattedData.length === 0 || allDisabled}/>\n            {customizeSelections}\n          </div>);\n        }\n        // Body Cell\n        let renderCell;\n        if (selectionType === 'radio') {\n            renderCell = (_, record, index) => {\n                const key = getRowKey(record, index);\n                return (<Radio {...checkboxPropsMap.get(key)} checked={keySet.has(key)} onChange={event => {\n                    if (!keySet.has(key)) {\n                        triggerSingleSelection(key, true, [key], event.nativeEvent);\n                    }\n                }}/>);\n            };\n        }\n        else {\n            renderCell = (_, record, index) => {\n                const key = getRowKey(record, index);\n                const hasKey = keySet.has(key);\n                // Record checked\n                return (<Checkbox {...checkboxPropsMap.get(key)} checked={hasKey} onChange={({ nativeEvent }) => {\n                    const { shiftKey } = nativeEvent;\n                    let startIndex = -1;\n                    let endIndex = -1;\n                    // Get range of this\n                    if (shiftKey) {\n                        const pointKeys = new Set([lastSelectedKey, key]);\n                        recordKeys.some((recordKey, recordIndex) => {\n                            if (pointKeys.has(recordKey)) {\n                                if (startIndex === -1) {\n                                    startIndex = recordIndex;\n                                }\n                                else {\n                                    endIndex = recordIndex;\n                                    return true;\n                                }\n                            }\n                            return false;\n                        });\n                    }\n                    if (endIndex !== -1 && startIndex !== endIndex) {\n                        // Batch update selections\n                        const rangeKeys = recordKeys.slice(startIndex, endIndex + 1);\n                        const changedKeys = [];\n                        if (hasKey) {\n                            rangeKeys.forEach(recordKey => {\n                                if (keySet.has(recordKey)) {\n                                    changedKeys.push(recordKey);\n                                    keySet.delete(recordKey);\n                                }\n                            });\n                        }\n                        else {\n                            rangeKeys.forEach(recordKey => {\n                                if (!keySet.has(recordKey)) {\n                                    changedKeys.push(recordKey);\n                                    keySet.add(recordKey);\n                                }\n                            });\n                        }\n                        const keys = Array.from(keySet);\n                        setSelectedKeys(keys);\n                        if (onSelectMultiple) {\n                            onSelectMultiple(!hasKey, keys.map(recordKey => getRecordByKey(recordKey)), changedKeys.map(recordKey => getRecordByKey(recordKey)));\n                        }\n                    }\n                    else {\n                        // Single record selected\n                        if (hasKey) {\n                            keySet.delete(key);\n                        }\n                        else {\n                            keySet.add(key);\n                        }\n                        triggerSingleSelection(key, !hasKey, Array.from(keySet), nativeEvent);\n                    }\n                    setLastSelectedKey(key);\n                }}/>);\n            };\n        }\n        // Columns\n        const selectionColumn = {\n            width: selectionColWidth,\n            className: `${prefixCls}-selection-column`,\n            title: rowSelection.columnTitle || title,\n            render: renderCell,\n        };\n        if (expandType === 'row' && columns.length && !expandIconColumnIndex) {\n            const [expandColumn, ...restColumns] = columns;\n            return [\n                expandColumn,\n                Object.assign(Object.assign({}, selectionColumn), { fixed: fixed || getFixedType(restColumns[0]) }),\n                ...restColumns,\n            ];\n        }\n        return [Object.assign(Object.assign({}, selectionColumn), { fixed: fixed || getFixedType(columns[0]) }), ...columns];\n    }, [\n        getRowKey,\n        pageData,\n        rowSelection,\n        innerSelectedKeys,\n        mergedSelectedKeys,\n        selectionColWidth,\n        mergedSelections,\n        expandType,\n        lastSelectedKey,\n        onSelectMultiple,\n        triggerSingleSelection,\n    ]);\n    return [transformColumns, mergedSelectedKeySet];\n}\n"],"file":"useSelection.js"}