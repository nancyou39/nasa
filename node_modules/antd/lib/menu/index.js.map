{"version":3,"sources":["menu/index.jsx"],"names":["InternalMenu","props","handleMouseEnter","e","restoreModeVerticalFromInline","onMouseEnter","handleTransitionEnd","widthCollapsed","propertyName","target","currentTarget","className","classNameValue","Object","prototype","toString","call","animVal","iconScaled","indexOf","handleClick","handleOpenChange","onClick","openKeys","setOpenKeys","onOpenChange","renderMenu","getPopupContainer","getPrefixCls","direction","customizePrefixCls","prefixCls","theme","collapsedWidth","passProps","menuMode","getRealMenuMode","menuOpenMotion","getOpenMotionProps","menuClassName","getInlineCollapsed","menuProps","state","mode","hideMenu","inlineCollapsed","antdMenuTheme","siderCollapsed","undefined","defaultOpenKeys","switchingModeFromInline","inlineOpenKeys","prevProps","raf","cancel","mountRafId","setState","openTransitionName","openAnimation","motion","motionName","collapseMotion","nextProps","prevState","newState","React","Component","defaultProps","focusable","Menu","context","Divider","Item","SubMenu","ItemGroup"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport RcMenu, { Divider, ItemGroup } from 'rc-menu';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport SubMenu from './SubMenu';\nimport Item from './MenuItem';\nimport { ConfigConsumer } from '../config-provider';\nimport warning from '../_util/warning';\nimport { SiderContext } from '../layout/Sider';\nimport raf from '../_util/raf';\nimport collapseMotion from '../_util/motion';\nimport MenuContext from './MenuContext';\nclass InternalMenu extends React.Component {\n    constructor(props) {\n        super(props);\n        // Restore vertical mode when menu is collapsed responsively when mounted\n        // https://github.com/ant-design/ant-design/issues/13104\n        // TODO: not a perfect solution, looking a new way to avoid setting switchingModeFromInline in this situation\n        this.handleMouseEnter = (e) => {\n            this.restoreModeVerticalFromInline();\n            const { onMouseEnter } = this.props;\n            if (onMouseEnter) {\n                onMouseEnter(e);\n            }\n        };\n        this.handleTransitionEnd = (e) => {\n            // when inlineCollapsed menu width animation finished\n            // https://github.com/ant-design/ant-design/issues/12864\n            const widthCollapsed = e.propertyName === 'width' && e.target === e.currentTarget;\n            // Fix SVGElement e.target.className.indexOf is not a function\n            // https://github.com/ant-design/ant-design/issues/15699\n            const { className } = e.target;\n            // SVGAnimatedString.animVal should be identical to SVGAnimatedString.baseVal, unless during an animation.\n            const classNameValue = Object.prototype.toString.call(className) === '[object SVGAnimatedString]'\n                ? className.animVal\n                : className;\n            // Fix for <Menu style={{ width: '100%' }} />, the width transition won't trigger when menu is collapsed\n            // https://github.com/ant-design/ant-design-pro/issues/2783\n            const iconScaled = e.propertyName === 'font-size' && classNameValue.indexOf('anticon') >= 0;\n            if (widthCollapsed || iconScaled) {\n                this.restoreModeVerticalFromInline();\n            }\n        };\n        this.handleClick = (e) => {\n            this.handleOpenChange([]);\n            const { onClick } = this.props;\n            if (onClick) {\n                onClick(e);\n            }\n        };\n        this.handleOpenChange = (openKeys) => {\n            this.setOpenKeys(openKeys);\n            const { onOpenChange } = this.props;\n            if (onOpenChange) {\n                onOpenChange(openKeys);\n            }\n        };\n        this.renderMenu = ({ getPopupContainer, getPrefixCls, direction }) => {\n            const { prefixCls: customizePrefixCls, className, theme, collapsedWidth } = this.props;\n            const passProps = omit(this.props, ['collapsedWidth', 'siderCollapsed']);\n            const menuMode = this.getRealMenuMode();\n            const menuOpenMotion = this.getOpenMotionProps(menuMode);\n            const prefixCls = getPrefixCls('menu', customizePrefixCls);\n            const menuClassName = classNames(className, `${prefixCls}-${theme}`, {\n                [`${prefixCls}-inline-collapsed`]: this.getInlineCollapsed(),\n            });\n            const menuProps = Object.assign({ openKeys: this.state.openKeys, onOpenChange: this.handleOpenChange, className: menuClassName, mode: menuMode }, menuOpenMotion);\n            if (menuMode !== 'inline') {\n                // closing vertical popup submenu after click it\n                menuProps.onClick = this.handleClick;\n            }\n            // https://github.com/ant-design/ant-design/issues/8587\n            const hideMenu = this.getInlineCollapsed() &&\n                (collapsedWidth === 0 || collapsedWidth === '0' || collapsedWidth === '0px');\n            if (hideMenu) {\n                menuProps.openKeys = [];\n            }\n            return (<MenuContext.Provider value={{\n                inlineCollapsed: this.getInlineCollapsed() || false,\n                antdMenuTheme: this.props.theme,\n                direction,\n            }}>\n        <RcMenu getPopupContainer={getPopupContainer} {...passProps} {...menuProps} prefixCls={prefixCls} onTransitionEnd={this.handleTransitionEnd} onMouseEnter={this.handleMouseEnter} direction={direction}/>\n      </MenuContext.Provider>);\n        };\n        warning(!('inlineCollapsed' in props && props.mode !== 'inline'), 'Menu', '`inlineCollapsed` should only be used when `mode` is inline.');\n        warning(!(props.siderCollapsed !== undefined && 'inlineCollapsed' in props), 'Menu', '`inlineCollapsed` not control Menu under Sider. Should set `collapsed` on Sider instead.');\n        let openKeys;\n        if ('openKeys' in props) {\n            openKeys = props.openKeys;\n        }\n        else if ('defaultOpenKeys' in props) {\n            openKeys = props.defaultOpenKeys;\n        }\n        this.state = {\n            openKeys: openKeys || [],\n            switchingModeFromInline: false,\n            inlineOpenKeys: [],\n            prevProps: props,\n        };\n    }\n    static getDerivedStateFromProps(nextProps, prevState) {\n        const { prevProps } = prevState;\n        const newState = {\n            prevProps: nextProps,\n        };\n        if (prevProps.mode === 'inline' && nextProps.mode !== 'inline') {\n            newState.switchingModeFromInline = true;\n        }\n        if ('openKeys' in nextProps) {\n            newState.openKeys = nextProps.openKeys;\n        }\n        else {\n            // [Legacy] Old code will return after `openKeys` changed.\n            // Not sure the reason, we should keep this logic still.\n            if ((nextProps.inlineCollapsed && !prevProps.inlineCollapsed) ||\n                (nextProps.siderCollapsed && !prevProps.siderCollapsed)) {\n                newState.switchingModeFromInline = true;\n                newState.inlineOpenKeys = prevState.openKeys;\n                newState.openKeys = [];\n            }\n            if ((!nextProps.inlineCollapsed && prevProps.inlineCollapsed) ||\n                (!nextProps.siderCollapsed && prevProps.siderCollapsed)) {\n                newState.openKeys = prevState.inlineOpenKeys;\n                newState.inlineOpenKeys = [];\n            }\n        }\n        return newState;\n    }\n    componentWillUnmount() {\n        raf.cancel(this.mountRafId);\n    }\n    setOpenKeys(openKeys) {\n        if (!('openKeys' in this.props)) {\n            this.setState({ openKeys });\n        }\n    }\n    getRealMenuMode() {\n        const inlineCollapsed = this.getInlineCollapsed();\n        if (this.state.switchingModeFromInline && inlineCollapsed) {\n            return 'inline';\n        }\n        const { mode } = this.props;\n        return inlineCollapsed ? 'vertical' : mode;\n    }\n    getInlineCollapsed() {\n        const { inlineCollapsed } = this.props;\n        if (this.props.siderCollapsed !== undefined) {\n            return this.props.siderCollapsed;\n        }\n        return inlineCollapsed;\n    }\n    getOpenMotionProps(menuMode) {\n        const { openTransitionName, openAnimation, motion } = this.props;\n        // Provides by user\n        if (motion) {\n            return { motion };\n        }\n        if (openAnimation) {\n            warning(typeof openAnimation === 'string', 'Menu', '`openAnimation` do not support object. Please use `motion` instead.');\n            return { openAnimation };\n        }\n        if (openTransitionName) {\n            return { openTransitionName };\n        }\n        // Default logic\n        if (menuMode === 'horizontal') {\n            return { motion: { motionName: 'slide-up' } };\n        }\n        if (menuMode === 'inline') {\n            return { motion: collapseMotion };\n        }\n        // When mode switch from inline\n        // submenu should hide without animation\n        return {\n            motion: {\n                motionName: this.state.switchingModeFromInline ? '' : 'zoom-big',\n            },\n        };\n    }\n    restoreModeVerticalFromInline() {\n        const { switchingModeFromInline } = this.state;\n        if (switchingModeFromInline) {\n            this.setState({\n                switchingModeFromInline: false,\n            });\n        }\n    }\n    render() {\n        return <ConfigConsumer>{this.renderMenu}</ConfigConsumer>;\n    }\n}\nInternalMenu.defaultProps = {\n    className: '',\n    theme: 'light',\n    focusable: false,\n};\n// We should keep this as ref-able\nexport default class Menu extends React.Component {\n    render() {\n        return (<SiderContext.Consumer>\n        {(context) => <InternalMenu {...this.props} {...context}/>}\n      </SiderContext.Consumer>);\n    }\n}\nMenu.Divider = Divider;\nMenu.Item = Item;\nMenu.SubMenu = SubMenu;\nMenu.ItemGroup = ItemGroup;\n"],"file":"index.js"}